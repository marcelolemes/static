
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>TESTE</title>

    <link href="https://fonts.googleapis.com/css?family=Faster+One" rel="stylesheet">
    
  </head>

  <body>

      <header>

      </header>

      <section id="section1">
        Filtrar por: <input type="search" id="pesquisa" oninput="recarrega()"> 
        <button type="button" onclick="limpar()">Filtrar</button>

      </section>
      <section id="section2">
 

      </section>
    <script>
    async function populate() {

      const requestURL = 'https://api.github.com/users/marcelolemes/repos';
      const request = new Request(requestURL);

      const response = await fetch(request);
      const ReposText = await response.text();

      Repositories = JSON.parse(ReposText);

     
      populateRepos(Repositories);
	  

    }
    populate();
   function populateRepos(obj) {
      const section = document.querySelector('section');
      section.id = `section2`;
      
      for (const repo of obj) {
        const myArticle = document.createElement('article');
        const myH2 = document.createElement('h2');
        const myPara1 = document.createElement('p');
        const myPara2 = document.createElement('p');
        const myPara3 = document.createElement('p');
        const myList = document.createElement('ul');

        myH2.textContent = repo.name;
        myPara1.textContent = `Repo Name: ${repo.name}`;
        myPara2.textContent = `Clone Url: ${repo.clone_url}`;
        myPara3.textContent = `Pushed at: ${repo.pushed_at}`;
        myArticle.className = `article`;
        myArticle.id = `${repo.name}`.toUpperCase();
        myArticle.appendChild(myH2);
        myArticle.appendChild(myPara1);
        myArticle.appendChild(myPara2);
        myArticle.appendChild(myPara3);
        myArticle.appendChild(myList);
        section.appendChild(myArticle);
      }
    }
    function limpar(){
    let lista=[]; 
    let x = document.getElementById("section2").querySelectorAll(".article");
    for (var i=0, max=x.length; i < max; i++) {
      if (x[i].id.startsWith(document.getElementById("pesquisa").value.toUpperCase())){
        //document.getElementById(x[i].id).style.visibility='visible';
        lista.push(document.getElementById(x[i].id));
      }
      else{
        //document.getElementById(x[i].id).style.visibility='hidden';
      }
      populateRepos(lista);
    } 
       
      }
      function recarrega() {
        const section = document.getElementById('section2');
        let filhos = section.childNodes;
        for( i = filhos.length - 1; i >= 0; i-- ) {
          if( filhos[i].className == 'article' ) {
            section.removeChild( filhos[i] );
          }
        }

        const myArticle = document.createElement('article');
        for (const repo of Repositories) {
          if(repo.name.toUpperCase()
          .startsWith(document.getElementById("pesquisa")
          .value.toUpperCase())){
            const myH2 = document.createElement('h2');
            const myPara1 = document.createElement('p');
            const myPara2 = document.createElement('p');
            const myPara3 = document.createElement('p');
            const myList = document.createElement('ul');

            myH2.textContent = repo.name;
            myPara1.textContent = `Repo Name: ${repo.name}`;
            myPara2.textContent = `Clone Url: ${repo.clone_url}`;
            myPara3.textContent = `Pushed at: ${repo.pushed_at}`;
            myArticle.className = `article`;
            myArticle.id = `${repo.name}`.toUpperCase();
            myArticle.appendChild(myH2);
            myArticle.appendChild(myPara1);
            myArticle.appendChild(myPara2);
            myArticle.appendChild(myPara3);
            myArticle.appendChild(myList);
            section.appendChild(myArticle);
        }
      }
 
} 
    
   
          
    
    </script>
  </body>
</html>
